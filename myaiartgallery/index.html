<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My AI Art Gallery</title>
  <link rel="icon" href="/cube-favicon.jpeg" type="image/jpeg">
  <style>
    /* Basic styling for your gallery */
    body { font-family: sans-serif; background: #fdf0e6; margin: 0; padding: 2rem; text-align: center; }
    .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; max-width: 1200px; margin: 0 auto; }
    .gallery-item { background: #fff; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); overflow: hidden; }
    .gallery-item img, .gallery-item video { width: 100%; height: auto; }
    .status { margin-top: 1rem; color: #666; }
  </style>
</head>
<body>
  <h1>My AI Art Gallery</h1>
  <div class="gallery-grid" id="galleryGrid"></div>
  <div id="statusMsg" class="status">Loading AI Art...</div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    const SUPABASE_URL = 'https://wsymagxhyzqeilrtjvmo.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndzeW1hZ3hoeXpxZWlscnRqdm1vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE0NTI2OTEsImV4cCI6MjA1NzAyODY5MX0.HBDO-7LKoUxnPUd58XGqzp8O63YrDKxJ92zUD2ABb_o';
    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const bucketName = 'myaiartgallery';
    const galleryGrid = document.getElementById('galleryGrid');
    const statusMsg = document.getElementById('statusMsg');

    async function loadGallery() {
      try {
        // 1) List items in the bucket
        const { data, error } = await supabase
          .storage
          .from(bucketName)
          .list('', { limit: 100 });
        if (error) throw error;
        if (!data || data.length === 0) {
          statusMsg.textContent = 'No AI art found!';
          return;
        }

        let itemsHTML = '';
        for (const fileObj of data) {
          // 2) For each file, get a public URL
          const { data: publicURLData } = supabase
            .storage
            .from(bucketName)
            .getPublicUrl(fileObj.name);

          const fileURL = publicURLData.publicUrl;
          // 3) Check if it's video or image by extension
          const lowerName = fileObj.name.toLowerCase();
          if (lowerName.endsWith('.mp4') || lowerName.endsWith('.webm') || lowerName.endsWith('.mov')) {
            itemsHTML += `
              <div class="gallery-item">
                <video src="${fileURL}" controls></video>
              </div>
            `;
          } else {
            // default to <img>
            itemsHTML += `
              <div class="gallery-item">
                <img src="${fileURL}" alt="${fileObj.name}">
              </div>
            `;
          }
        }

        galleryGrid.innerHTML = itemsHTML;
        statusMsg.textContent = '';
      } catch (err) {
        console.error(err);
        statusMsg.textContent = 'Error loading gallery.';
      }
    }

    loadGallery();
  </script>
</body>
</html>
